# ===================================================================
# LAWLESS DIRECTORY - PRODUCTION ENVIRONMENT CONFIGURATION
# ===================================================================
# Copy this file to .env.local and replace ALL placeholder values
# CRITICAL: Never commit .env.local to version control!
# File permissions: chmod 600 .env.local

# ===== CORE APPLICATION SETTINGS =====
NODE_ENV=production
NEXT_PUBLIC_APP_URL=https://yourdomain.com
NEXT_PUBLIC_SITE_URL=https://yourdomain.com

# ===== SUPABASE CONFIGURATION =====
# Get these from your Supabase project dashboard
NEXT_PUBLIC_SUPABASE_URL=https://your-project-ref.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-supabase-anon-key-here
SUPABASE_SERVICE_ROLE_KEY=your-supabase-service-role-key-here
SUPABASE_ACCESS_TOKEN=your-supabase-access-token-here
SUPABASE_DB_PASSWORD=your-secure-database-password

# ===== OAUTH SECURITY KEYS =====
# Generate with: openssl rand -hex 32
TOKEN_ENCRYPTION_KEY=your-64-char-hex-token-encryption-key-generate-with-openssl
CONFIG_ENCRYPTION_KEY=your-64-char-hex-config-encryption-key-generate-with-openssl
# Generate with: openssl rand -base64 48 | tr -d "=+/" | cut -c1-64
OAUTH_HMAC_KEY=your-64-char-oauth-hmac-key-for-state-parameter-signing

# ===== GOOGLE OAUTH CONFIGURATION =====
# Set up at: https://console.developers.google.com/
# Required scopes: openid email profile
GOOGLE_CLIENT_ID=your-google-client-id.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=GOCSPX-your-secure-google-client-secret
GOOGLE_ENABLED=true
GOOGLE_REDIRECT_URI=https://yourdomain.com/api/auth/oauth/google/callback

# ===== APPLE SIGN-IN CONFIGURATION =====
# Set up at: https://developer.apple.com/account/resources/identifiers/
# Requires Apple Developer Program membership
APPLE_CLIENT_ID=com.yourdomain.app
# Apple client secret is a JWT - generate using Apple's private key
APPLE_CLIENT_SECRET=your-apple-jwt-client-secret-token
APPLE_TEAM_ID=your-10-char-apple-team-id
APPLE_KEY_ID=your-10-char-apple-key-id
# Path to your Apple AuthKey_XXXXXXXXXX.p8 file
APPLE_PRIVATE_KEY_PATH=/path/to/AuthKey_XXXXXXXXXX.p8
APPLE_ENABLED=true
APPLE_REDIRECT_URI=https://yourdomain.com/api/auth/oauth/apple/callback

# ===== FACEBOOK OAUTH CONFIGURATION =====
# Set up at: https://developers.facebook.com/apps/
# Required permissions: email, public_profile
FACEBOOK_CLIENT_ID=your-facebook-app-id
FACEBOOK_CLIENT_SECRET=your-secure-facebook-app-secret
FACEBOOK_ENABLED=true
FACEBOOK_REDIRECT_URI=https://yourdomain.com/api/auth/oauth/facebook/callback

# ===== GITHUB OAUTH CONFIGURATION =====
# Set up at: https://github.com/settings/developers
# Required scopes: read:user user:email
GITHUB_CLIENT_ID=Iv1.your-github-client-id
GITHUB_CLIENT_SECRET=your-secure-github-client-secret
GITHUB_ENABLED=true
GITHUB_REDIRECT_URI=https://yourdomain.com/api/auth/oauth/github/callback

# ===== OAUTH SECURITY POLICIES =====
# Rate limiting configuration
OAUTH_RATE_LIMIT_ENABLED=true
OAUTH_MAX_ATTEMPTS_PER_MINUTE=5
OAUTH_BLOCK_DURATION_MINUTES=15

# Security enforcement
OAUTH_ENFORCE_HTTPS=true
OAUTH_ENFORCE_PKCE=true
OAUTH_REQUIRE_STATE_VALIDATION=true

# Account linking policies
ACCOUNT_LINKING_REQUIRE_REAUTH=true
ACCOUNT_LINKING_REQUIRE_EMAIL_VERIFICATION=true

# Token management
TOKEN_REFRESH_ENABLED=true
TOKEN_REFRESH_THRESHOLD_HOURS=1
TOKEN_REFRESH_MAX_RETRIES=3

# ===== REDIRECT URI SECURITY =====
# Comma-separated list of allowed redirect origins
ALLOWED_REDIRECT_ORIGINS=https://yourdomain.com,https://app.yourdomain.com
# Block OAuth redirects to external domains
OAUTH_ALLOW_EXTERNAL_REDIRECTS=false

# ===== SECURITY MONITORING =====
OAUTH_SECURITY_LOGGING=true
OAUTH_AUDIT_RETENTION_DAYS=90
OAUTH_ALERT_ON_SUSPICIOUS_ACTIVITY=true
OAUTH_ALERT_ON_RATE_LIMIT_EXCEEDED=true

# Security webhook for alerts
OAUTH_SECURITY_WEBHOOK_URL=https://yourdomain.com/api/webhooks/security-alerts

# ===== COMPLIANCE SETTINGS =====
# OAuth 2.1 compliance mode
OAUTH_COMPLIANCE_MODE=oauth2.1
# GDPR compliance for EU users
GDPR_COMPLIANCE_ENABLED=true
# Data retention policies
DATA_RETENTION_DAYS=2555  # 7 years for business compliance

# ===== DEVELOPMENT OVERRIDES =====
# WARNING: NEVER set these to true in production!
OAUTH_ALLOW_HTTP_REDIRECTS=false
OAUTH_ALLOW_LOCALHOST=false
OAUTH_DISABLE_SSL_VERIFICATION=false

# ===================================================================
# SETUP INSTRUCTIONS
# ===================================================================
#
# 1. SECURITY KEYS GENERATION:
#    TOKEN_ENCRYPTION_KEY: openssl rand -hex 32
#    CONFIG_ENCRYPTION_KEY: openssl rand -hex 32
#    OAUTH_HMAC_KEY: openssl rand -base64 48 | tr -d "=+/" | cut -c1-64
#
# 2. GOOGLE OAUTH SETUP:
#    - Go to: https://console.developers.google.com/
#    - Create new project or select existing
#    - Enable Google+ API
#    - Create OAuth 2.0 credentials
#    - Add authorized redirect URI: https://yourdomain.com/api/auth/oauth/google/callback
#    - Copy Client ID and Client Secret
#
# 3. APPLE SIGN-IN SETUP:
#    - Requires Apple Developer Program ($99/year)
#    - Go to: https://developer.apple.com/account/resources/identifiers/
#    - Create new App ID with Sign In with Apple capability
#    - Create Service ID for web authentication
#    - Generate private key and download AuthKey_XXXXXXXXXX.p8
#    - Add domain and redirect URL to Service ID
#
# 4. FACEBOOK OAUTH SETUP:
#    - Go to: https://developers.facebook.com/apps/
#    - Create new app with "Consumer" type
#    - Add Facebook Login product
#    - Add Valid OAuth Redirect URI: https://yourdomain.com/api/auth/oauth/facebook/callback
#    - Copy App ID and App Secret from Basic Settings
#
# 5. GITHUB OAUTH SETUP:
#    - Go to: https://github.com/settings/developers
#    - Click "New OAuth App"
#    - Set Authorization callback URL: https://yourdomain.com/api/auth/oauth/github/callback
#    - Copy Client ID and generate Client Secret
#
# ===================================================================
# PRODUCTION CHECKLIST
# ===================================================================
# [ ] All placeholder values replaced with actual credentials
# [ ] Security keys generated using cryptographically secure methods
# [ ] OAuth apps configured with correct redirect URIs
# [ ] HTTPS enforced (OAUTH_ENFORCE_HTTPS=true)
# [ ] Rate limiting enabled and configured
# [ ] Security monitoring enabled
# [ ] Environment file permissions set to 600
# [ ] Environment file added to .gitignore
# [ ] All OAuth providers tested in production environment
# [ ] Error handling flows validated
# [ ] User account linking tested
# [ ] GDPR compliance verified for EU users
# [ ] Security incident response procedures documented
# [ ] Backup authentication methods available
#
# ===================================================================
# SECURITY NOTES
# ===================================================================
# - Never commit this file to version control
# - Use different keys for each environment (dev, staging, production)
# - Rotate keys regularly (every 90 days recommended)
# - Monitor OAuth provider security advisories
# - Implement proper key management in production (Vault, AWS Secrets Manager, etc.)
# - Regular security audits of OAuth flows
# - Test OAuth failure scenarios and error handling
# ===================================================================

# ===== ADDITIONAL APPLICATION SETTINGS =====
# Analytics and monitoring (optional)
GOOGLE_ANALYTICS_ID=G-XXXXXXXXXX
SENTRY_DSN=https://your-sentry-dsn

# Email service configuration (for OAuth verification emails)
SENDGRID_API_KEY=your-sendgrid-api-key
SMTP_HOST=smtp.sendgrid.net
SMTP_PORT=587
SMTP_USER=apikey
SMTP_PASS=your-sendgrid-api-key

# Content Security Policy for OAuth providers
CSP_OAUTH_SOURCES="'self' https://accounts.google.com https://appleid.apple.com https://www.facebook.com https://github.com"