# OAuth Security Configuration - REQUIRED FOR PRODUCTION
# 
# This file contains critical security configurations for OAuth authentication.
# All keys must be generated using cryptographically secure methods.
# DO NOT use the example values in production!

# ===== TOKEN ENCRYPTION =====
# 64-character hex key (32 bytes) for AES-256-GCM token encryption
# Generate with: openssl rand -hex 32
TOKEN_ENCRYPTION_KEY=0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef

# ===== OAUTH STATE SECURITY =====
# Minimum 32-character key for HMAC-SHA256 state parameter signing
# Generate with: openssl rand -base64 48
OAUTH_HMAC_KEY=your-secure-hmac-key-must-be-at-least-32-characters-long-for-security

# ===== CONFIGURATION ENCRYPTION =====  
# 64-character hex key (32 bytes) for encrypting OAuth provider configurations
# Generate with: openssl rand -hex 32
CONFIG_ENCRYPTION_KEY=fedcba9876543210fedcba9876543210fedcba9876543210fedcba9876543210

# ===== REDIRECT URI SECURITY =====
# Base URL for your application (used for redirect validation)
NEXT_PUBLIC_SITE_URL=https://yourdomain.com

# Comma-separated list of allowed redirect origins (in addition to NEXT_PUBLIC_SITE_URL)
ALLOWED_REDIRECT_ORIGINS=https://app.yourdomain.com,https://admin.yourdomain.com

# ===== OAUTH PROVIDER CREDENTIALS =====
# Google OAuth Configuration
GOOGLE_CLIENT_ID=your-google-client-id.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=GOCSPX-your-secure-google-client-secret-with-sufficient-complexity
GOOGLE_ENABLED=true
GOOGLE_REDIRECT_URI=https://yourdomain.com/api/auth/oauth/google/callback

# Apple OAuth Configuration
APPLE_CLIENT_ID=com.yourdomain.app
APPLE_CLIENT_SECRET=your-apple-client-secret-jwt-token-with-proper-signing
APPLE_ENABLED=true
APPLE_REDIRECT_URI=https://yourdomain.com/api/auth/oauth/apple/callback

# Facebook OAuth Configuration
FACEBOOK_CLIENT_ID=your-facebook-app-id
FACEBOOK_CLIENT_SECRET=your-secure-facebook-app-secret-with-complexity-requirements
FACEBOOK_ENABLED=true
FACEBOOK_REDIRECT_URI=https://yourdomain.com/api/auth/oauth/facebook/callback

# GitHub OAuth Configuration  
GITHUB_CLIENT_ID=Iv1.your-github-client-id
GITHUB_CLIENT_SECRET=your-secure-github-client-secret-with-proper-entropy-levels
GITHUB_ENABLED=true
GITHUB_REDIRECT_URI=https://yourdomain.com/api/auth/oauth/github/callback

# ===== SECURITY POLICIES =====
# Rate limiting configuration
OAUTH_RATE_LIMIT_ENABLED=true
OAUTH_MAX_ATTEMPTS_PER_MINUTE=5
OAUTH_BLOCK_DURATION_MINUTES=15

# Account linking security
ACCOUNT_LINKING_REQUIRE_REAUTH=true
ACCOUNT_LINKING_REQUIRE_EMAIL_VERIFICATION=true

# Token refresh policies
TOKEN_REFRESH_ENABLED=true
TOKEN_REFRESH_THRESHOLD_HOURS=1
TOKEN_REFRESH_MAX_RETRIES=3

# ===== AUDIT AND COMPLIANCE =====
# Enable comprehensive security logging
OAUTH_SECURITY_LOGGING=true
OAUTH_AUDIT_RETENTION_DAYS=90

# Compliance mode (enforces stricter security)
OAUTH_COMPLIANCE_MODE=oauth2.1
OAUTH_ENFORCE_PKCE=true
OAUTH_REQUIRE_HTTPS=true

# ===== MONITORING AND ALERTS =====
# Security monitoring endpoints
OAUTH_SECURITY_WEBHOOK_URL=https://yourdomain.com/api/webhooks/security-alerts
OAUTH_ALERT_ON_SUSPICIOUS_ACTIVITY=true
OAUTH_ALERT_ON_RATE_LIMIT_EXCEEDED=true

# ===== DEVELOPMENT/TESTING OVERRIDES =====
# Only use in development - allows HTTP and localhost
# DO NOT SET TO true IN PRODUCTION
OAUTH_ALLOW_HTTP_REDIRECTS=false
OAUTH_ALLOW_LOCALHOST=false

# Generate new keys with these commands:
# TOKEN_ENCRYPTION_KEY: openssl rand -hex 32
# CONFIG_ENCRYPTION_KEY: openssl rand -hex 32  
# OAUTH_HMAC_KEY: openssl rand -base64 48 | tr -d "=+/" | cut -c1-32

# Security checklist:
# [ ] All keys are randomly generated using cryptographically secure methods
# [ ] No example/default values are used in production
# [ ] OAuth client secrets meet provider complexity requirements
# [ ] HTTPS is enforced in production (OAUTH_REQUIRE_HTTPS=true)
# [ ] Rate limiting is enabled and properly configured
# [ ] Audit logging is enabled for compliance
# [ ] All redirect URIs are properly validated and whitelisted
# [ ] Account linking requires proper authentication
# [ ] Environment file has restricted permissions (600)

# File permissions: chmod 600 .env.local